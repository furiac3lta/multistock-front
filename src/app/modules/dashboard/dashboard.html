


<div class="dashboard-container">

  <div class="page-header">
    <div class="page-titles">
      <p class="eyebrow">Resumen general</p>
      <h1 class="title">Dashboard</h1>
      <p class="subtitle">Control rápido del inventario, movimientos y actividad reciente.</p>
    </div>

    <app-branch-switcher class="branch-switcher"></app-branch-switcher>
  </div>

  <div class="card-grid">
    <div class="stat-card">
      <span class="pill">Productos</span>
      <p class="value">{{ totalProductos }}</p>
      <p class="muted">Totales en la sucursal</p>
    </div>

    <div class="stat-card">
      <span class="pill">Categorías</span>
      <p class="value">{{ totalCategorias }}</p>
      <p class="muted">Organización del catálogo</p>
    </div>

    <div class="stat-card">
      <span class="pill">Valor inventario</span>
      <p class="value">{{ valorInventario | currency:'ARS':'symbol':'1.0-0' }}</p>
      <p class="muted">Suma estimada de venta</p>
    </div>

    <div class="stat-card">
      <span class="pill">Stock total</span>
      <p class="value">{{ totalStock }}</p>
      <p class="muted">Unidades disponibles</p>
    </div>

    <div class="stat-card accent">
      <span class="pill">Movimientos hoy</span>
      <p class="value">{{ totalMovimientosHoy }}</p>
      <p class="muted">Ingresos y salidas</p>
    </div>
  </div>

  <div class="section-grid">
    <div class="section-card">
      <div class="section-head">
        <h2>Stock Bajo (≤ 5)</h2>
        <span class="badge" [class.ok]="stockBajo.length === 0">{{ stockBajo.length }} items</span>
      </div>

      <div *ngIf="stockBajo.length === 0" class="empty">No hay productos con stock bajo</div>

      <ul *ngIf="stockBajo.length > 0" class="list">
        <li *ngFor="let p of stockBajo">
          <div>
            <p class="item-title">{{ p.name }}</p>
            <p class="item-sub">ID: {{ p.id }}</p>
          </div>
          <span class="tag warning">Stock: {{ p.stock }}</span>
        </li>
      </ul>
    </div>

    <div class="section-card">
      <div class="section-head">
        <h2>Últimos Productos</h2>
        <span class="badge">{{ ultimosProductos.length }}</span>
      </div>
      <ul class="list">
        <li *ngFor="let p of ultimosProductos">
          <div>
            <p class="item-title">{{ p.name }}</p>
            <p class="item-sub">SKU: {{ p.sku }}</p>
          </div>
          <span class="tag">{{ p.salePrice | currency:'ARS':'symbol':'1.0-0' }}</span>
        </li>
      </ul>
    </div>

    <div class="section-card wide">
      <div class="section-head">
        <h2>Últimos Movimientos</h2>
        <span class="badge">{{ ultimosMovimientos.length }}</span>
      </div>
      <ul class="list movements">
        <li *ngFor="let m of ultimosMovimientos">
          <div class="movement-meta">
            <span class="tag ghost">{{ m.createdAt | date:'dd/MM HH:mm' }}</span>
            <p class="item-title">{{ m.productName }}</p>
          </div>
          <div class="movement-badges">
            <span
              class="tag"
              [class.success]="m.movementType === 'INCREASE'"
              [class.error]="m.movementType === 'DECREASE'"
            >
              {{ m.movementType === 'INCREASE' ? 'Ingreso' : 'Salida' }}
            </span>
            <span class="tag ghost">Cantidad: {{ m.quantity }}</span>
          </div>
        </li>
      </ul>
    </div>
  </div>

  <div class="section">
    <div class="section-head">
      <h2>Gráficos</h2>
      <p class="muted">Visualiza la distribución de stock y la tendencia de movimientos.</p>
    </div>

    <div class="charts-grid">

      <div class="chart-card">
        <h3>Stock por Categoría</h3>
        <canvas id="chartCategory"></canvas>
      </div>

      <div class="chart-card">
        <h3>Productos por Sucursal</h3>
        <canvas id="chartBranch"></canvas>
      </div>

      <div class="chart-card">
        <h3>Movimientos últimos 30 días</h3>
        <canvas id="chartMovements"></canvas>
      </div>

    </div>
  </div>

</div>
